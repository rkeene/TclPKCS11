CC = @CC@
CFLAGS = @CFLAGS@ @SHOBJFLAGS@
CPPFLAGS = @CPPFLAGS@ -I@srcdir@ @DEFS@
LDFLAGS =
SHOBJLDFLAGS = @SHOBJLDFLAGS@
LIBS = @LIBS@
INSTALL = @INSTALL@
PACKAGE_VERSION = @PACKAGE_VERSION@
TCL_PACKAGE_PATH = @TCL_PACKAGE_PATH@
PACKAGE_INSTALL_DIR = $(TCL_PACKAGE_PATH)/tclpkcs11$(PACKAGE_VERSION)
srcdir = @srcdir@

all: tclpkcs11.@SHOBJEXT@

tclpkcs11.o: $(srcdir)/tclpkcs11.c $(srcdir)/pkcs11.h $(srcdir)/pkcs11f.h $(srcdir)/pkcs11t.h
	$(CC) $(CPPFLAGS) $(CFLAGS) -o tclpkcs11.o -c $(srcdir)/tclpkcs11.c

tclpkcs11.@SHOBJEXT@: tclpkcs11.o
	$(CC) $(CPPFLAGS) $(CFLAGS) $(LDFLAGS) $(SHOBJLDFLAGS) -o tclpkcs11.@SHOBJEXT@ tclpkcs11.o $(LIBS)

install: tclpkcs11.@SHOBJEXT@ pkgIndex.tcl
	$(INSTALL) -d "$(DESTDIR)$(PACKAGE_INSTALL_DIR)"
	$(INSTALL) -m 0644 pkgIndex.tcl "$(DESTDIR)$(PACKAGE_INSTALL_DIR)"
	$(INSTALL) -m 0755 tclpkcs11.@SHOBJEXT@ "$(DESTDIR)$(PACKAGE_INSTALL_DIR)"

clean:
	rm -f tclpkcs11.@SHOBJEXT@ tclpkcs11.o
	rm -f tclpkcs11.@SHOBJEXT@.a tclpkcs11.@SHOBJEXT@.def

distclean: clean
	rm -rf autom4te.cache
	rm -f config.log config.status
	rm -f pkgIndex.tcl
	rm -f Makefile

mrproper: distclean
	rm -f aclocal.m4 config.guess config.sub configure install-sh

.PHONY: all install clean distclean mrproper
